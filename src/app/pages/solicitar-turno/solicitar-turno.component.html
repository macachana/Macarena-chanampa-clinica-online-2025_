<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
</head>
<body>
    <div class="contenedor-h">
        <div class="imagenFondo">
            <img src="https://i.postimg.cc/MK4HPRB3/59-C64206-ADC9-47-BF-961-C-F2-CA5750-A25-D.png"/>
        </div>
                @if(this.db.tipoUsuario == "paciente")
                {
                    @if(primeraSeleccion)
                    {
                        <div class="contenedor">

                            <div class="titulo">
                                <button class="btn btn-outline-primary botonVolver" (click)="volver()">Volver</button>
                                <label>Elija la especialidad:</label>
                            </div>
                            <div class="contenedor-especialidades">
                                @for(especialidad of this.listaEspecialidades; track especialidad)
                                {
                                    <div class="especialidades">
                                        <button (click)="seleccionarEspecialidad(especialidad)"><img class="especialidadImg" src="https://i.postimg.cc/59z68LyS/55-sin-t-tulo-1.png" /></button>
                                        <label>{{especialidad}}</label>
                                    </div>
                                }
                            </div>
                        </div>
                    }
                    @else if(segundaSeleccion)
                    {
                        <div class="contenedor">
                            <div class="titulo">
                                <button class="btn btn-outline-primary botonVolver" (click)="volver(2)">Volver</button>
                                <label>Elija el especialista:</label>
                            </div>
                            <div class="contenedor-especialidades">
                                @for(especialista of this.listaEspecialistas; track especialista.id)
                                {
                                    @if(especialista.especialidad == this.especialidadElegida || especialista.segundaEspecialidad == this.especialidadElegida)
                                    {
                                        <div class="especialidades">
                                            <label>{{especialista.nombre}}</label>
                                            @if(especialista.id != null)
                                            {
                                                <button (click)="seleccionarEspecialista(especialista.id)"><img class="especialidadImg" src="https://xrexkrbpejzmwszuhags.supabase.co/storage/v1/object/public/clinica/especialistas/{{especialista.nombre}}_Especialista" /></button>
                                            }
                                        </div>                                
                                    }
        
                                }
                            </div>
                        </div>
                    }
                    @else if(terceraSeleccion)
                    {
                        <div class="contenedor">

                            <div class="titulo">
                                <button class="btn btn-outline-primary botonVolver" (click)="volver(3)">Volver</button>
                                <label>Elija el día:</label>
                                <div class="botonesFecha">
                                    @for(fecha of listaFechas; track fecha)
                                    {
                                        <button class="btn btn-success" (click)="seleccionarFecha(fecha.fecha,fecha.dia)">{{fecha.fecha}} ({{fecha.dia}})</button>
                                    }
                                </div>
                            </div>    
                        </div>
                    }
                    @else if(this.cuartaSeleccion)
                    {
                        <div class="contenedorHorario">

                            <div class="titulo">
                                <button class="btn btn-outline-primary botonVolver" (click)="volver(4)">Volver</button>
                                <label>Por último, elija el horario:</label>
                                @if(this.horariosDisponibles.length > 0)
                                {
                                    <div class="botonesDias">
                                        @for(horario of this.horariosDisponibles; track horario)
                                        {
                                            <button class="btn btn-warning" (click)="generarPeticion(horario)">{{horario}}</button>
                                        }
                                    </div>
                                }
                                @else 
                                {
                                    <label style="color:rgb(136, 136, 0);">El especialista no tiene horario disponible en este día</label>                                    
                                }
                            </div>
                        </div>
                    }
                    @else if(this.quintaSeleccion)
                    {
                        <div class="contenedor">
                            <div class="titulo">
                                <button class="btn btn-outline-primary botonVolver" (click)="volver(5)">Volver</button>
                                <label>Resumen de turno solicitado:</label>
                                <div class="peticion">
                                    <label>Especialista: {{this.nombreEspecialistaEleg}}</label>
                                    <label>Especialidad: {{this.especialidadElegida}}</label>
                                    <label>Fecha: {{this.fechaElegida}}</label>
                                    <label>Horario: {{this.horarioElegido}}</label>
                                </div>
                                <button class="btn btn-outline-light" (click)="confirmarTurno()">CONFIRMAR TURNO</button>
                            </div>    
                        </div>                        
                    }
                }
                @else if(this.db.tipoUsuario == "administrador")
                {
                    @if(primeraSeleccion)
                    {
                        <div class="contenedorHorario">
                            <div class="titulo">
                                <button class="btn btn-outline-primary botonVolver" (click)="volver()">Volver</button>
                                <label class="subTitulo">Elija un paciente:</label>
                            </div>
                            <div class="listaUsuarios este" id="detalleseleccion" name="detalleseleccion">
                                <table class="table table-light table-bordered border-primary table-hover">
                                    <thead>
                                        <tr>
                                            <th>Imagen</th>
                                            <th>Nombre</th>
                                            <th>Edad</th>
                                            <th>DNI</th>
                                            <th>Correo</th>
                                            <th>Obra social</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @if(listaPacientes.length > 0)
                                        {
                                            @for(paciente of listaPacientes; track paciente.id)
                                            {
                                                <tr (click)="seleccionarPaciente(paciente.id)">
                                                    <td [appHighlight]="color">
                                                        <img class="imagenPerfil" src="https://xrexkrbpejzmwszuhags.supabase.co/storage/v1/object/public/clinica/pacientes/{{paciente.nombre}}_{{paciente.dni}}"/>
                                                    </td>   
                                                    <td>{{ paciente.nombre }} {{ paciente.apellido }}</td>
                                                    <td>{{ paciente.edad }}</td>
                                                    <td>{{ paciente.dni }}</td>
                                                    <td>{{ paciente.email }}</td>  
                                                    <td>{{ paciente.obraSocial }}</td>                           
                                                </tr>
                                            }
                                        }
                                    </tbody>
                                </table>
                            </div>                
                        </div>
                    }
                    @else if(segundaSeleccion)
                    {
                        <div class="contenedor">

                            <div class="titulo">
                                <button class="btn btn-outline-primary botonVolver" (click)="volver(2)">Volver</button>
                                <label>Elija la especialidad:</label>
                            </div>
                            <div class="contenedor-especialidades">
                                @for(especialidad of this.listaEspecialidades; track especialidad)
                                {
                                    <div class="especialidades">
                                        <button (click)="seleccionarEspecialidad(especialidad)"><img class="especialidadImg" src="https://i.postimg.cc/59z68LyS/55-sin-t-tulo-1.png" /></button>
                                        <label>{{especialidad}}</label>
                                    </div>
                                }
                            </div>
                        </div>   
                    }
                    @else if(terceraSeleccion)
                    {
                        <div class="contenedor">
                            <div class="titulo">
                                <button class="btn btn-outline-primary botonVolver" (click)="volver(3)">Volver</button>
                                <label>Elija el especialista:</label>
                            </div>
                            <div class="contenedor-especialidades">
                                @for(especialista of this.listaEspecialistas; track especialista.id)
                                {
                                    @if(especialista.especialidad == this.especialidadElegida || especialista.segundaEspecialidad == this.especialidadElegida)
                                    {
                                        <div class="especialidades">
                                            <label>{{especialista.nombre}}</label>
                                            @if(especialista.id != null)
                                            {
                                                <button (click)="seleccionarEspecialista(especialista.id)"><img class="especialidadImg" src="https://xrexkrbpejzmwszuhags.supabase.co/storage/v1/object/public/clinica/especialistas/{{especialista.nombre}}_Especialista" /></button>
                                            }
                                        </div>                                
                                    }
        
                                }
                            </div>
                        </div>        
                    }                
                    @else if(cuartaSeleccion)
                    {
                        <div class="contenedor">

                            <div class="titulo">
                                <button class="btn btn-outline-primary botonVolver" (click)="volver(4)">Volver</button>
                                <label>Elija el día:</label>
                                <div class="botonesFecha">
                                    @for(fecha of listaFechas; track fecha.id)
                                    {
                                        <button class="btn btn-success" (click)="seleccionarFecha(fecha.fecha,fecha.dia)">{{fecha.fecha}} ({{ fecha.dia }})</button>
                                    }
                                </div>
                            </div>    
                        </div>
                    }
                    @else if(quintaSeleccion)
                    {
                        <div class="contenedorHorario">

                            <div class="titulo">
                                <button class="btn btn-outline-primary botonVolver" (click)="volver(5)">Volver</button>
                                <label>Por último, elija el horario:</label>
                                <div class="botonesDias">
                                    @if(this.horariosDisponibles.length > 0)
                                    {
                                        @for(horario of this.horariosDisponibles; track horario)
                                        {
                                            <button class="btn btn-warning" (click)="generarPeticion(horario)">{{horario}}</button>
                                        }
                                    }
                                    @else 
                                    {
                                        <label [ngClass]="error ? 'tituloError' : ''">Lamentamos informar que el doctor no tiene turnos en este día</label>                                    
                                    }
                                </div>
                            </div>
                        </div>
                    }
                    @else 
                    {
                        <div class="contenedor">
                            <div class="titulo">
                                <button class="btn btn-outline-primary botonVolver" (click)="volver(5)">Volver</button>
                                <label>Resumen de turno solicitado:</label>
                                <div class="peticion">
                                    <label>Paciente: {{this.nombrePacienteEleg}}</label>
                                    <label>Especialista: {{this.nombreEspecialistaEleg}}</label>
                                    <label>Especialidad: {{this.especialidadElegida}}</label>
                                    <label>Fecha: {{this.fechaElegida}}</label>
                                    <label>Horario: {{this.horarioElegido}}</label>
                                </div>
                                <button class="btn btn-outline-light" (click)="confirmarTurno()">CONFIRMAR TURNO</button>
                            </div>    
                        </div> 
                    }
                }
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO"
    crossorigin="anonymous"></script>
</body>
</html>